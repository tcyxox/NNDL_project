# CAC

```py
# 训练参数
batch_size: int = 64
learning_rate: float = 1e-2
epochs: int = 300
target_recall: float = 0.95
seed: int = 42
# 实验开关
alpha: float 
lambda_w: float
anchor_mode: "axis_aligned"
```



通过val + train 划定 95% 阈值



| alpha | lambda | se   | Subclass Overall | Subclass Seen  | Subclass Unseen | Subclass AUROC  |
| ----- | ------ | ---- | ---------------- | -------------- | --------------- | --------------- |
| 10    | 0      | -1   | 77.80% ± 0.31%   | 85.49% ± 0.35% | 71.24% ± 0.83%  | 0.8908 ± 0.0009 |
| 10    | 0.1    | -1   | 74.53% ± 0.33%   | 84.43% ± 0.20% | 66.09% ± 0.66%  | 0.8646 ± 0.0007 |
| 8     | 0      | -1   | 76.75% ± 0.19%   | 84.90% ± 0.21% | 69.80% ± 0.48%  | 0.8844 ± 0.0010 |
| 15    | 0      | -1   | 77.31% ± 0.16%   | 85.37% ± 0.55% | 70.43% ± 0.45%  | 0.8891 ± 0.0006 |
| 10    | 0      | 4    | 77.78% ± 0.38%   | 85.29% ± 0.45% | 71.37% ± 1.03%  | 0.8916 ± 0.0022 |
| 10    | 0      | 2    | 78.05% ± 0.57%   | 85.76% ± 0.36% | 71.47% ± 1.02%  | 0.8931 ± 0.0015 |
| 10    | 0      | 8    | 77.96% ± 0.45%   | 84.98% ± 1.15% | 71.97% ± 1.05%  | 0.8923 ± 0.0021 |
| 10    | 0.1    | 2    | 67.38% ± 1.18%   | 86.98% ± 0.67% | 50.67% ± 2.37%  | 0.8215 ± 0.0034 |
| 10    | 0.1    | 4    | 67.58% ± 0.27%   | 86.27% ± 0.67% | 51.64% ± 0.99%  | 0.8237 ± 0.0031 |



通过 mean -1*Std

| alpha | lambda | se   | Subclass Overall | Subclass Seen  | Subclass Unseen | Subclass AUROC  |
| ----- | ------ | ---- | ---------------- | -------------- | --------------- | --------------- |
| 10    | 0      | -1   | 72.55% ± 0.24%   | 81.06% ± 0.29% | 65.28% ± 0.40%  | 0.8325 ± 0.0009 |

如果增大std_multiplier=3那么会没有unknown，说明聚的很笼



# CAC + OpenMix

| alpha | lambda | lambda_open | se   | Subclass Overall | Subclass Seen  | Subclass Unseen | Subclass AUROC  |
| ----- | ------ | ----------- | ---- | ---------------- | -------------- | --------------- | --------------- |
| 10    | 0      | 0.3         | 4    | 84.68% ± 0.25%   | 77.49% ± 0.99% | 90.80% ± 0.77%  | 0.9411 ± 0.0021 |
| 10    | 0      | 0.3         | -1   | 76.84% ± 0.46%   | 84.71% ± 0.28% | 70.13% ± 0.92%  | 0.8978 ± 0.0025 |
| 10    | 0      | 0.1         | -1   | 78.79% ± 0.93%   | 82.75% ± 0.62% | 75.42% ± 2.22%  | 0.8916 ± 0.0015 |
| 10    | 0      | 0.1         | 4    | 83.57% ± 0.47%   | 80.55% ± 0.72% | 86.15% ± 0.49%  | 0.9131 ± 0.0010 |
| 10    | 0      | 0.5         | 4    | 86.17% ± 0.30%   | 77.45% ± 0.43% | 93.61% ± 0.42%  | 0.9526 ± 0.0027 |
| 10    | 0.1    | 0.3         | 4    | 84.39% ± 0.34%   | 79.84% ± 0.91% | 88.26% ± 0.50%  | 0.9303 ± 0.0019 |



# CAC + OpenMax

| alpha | lambda | alpha_max | tail | se   | Subclass Overall | Subclass Seen  | Subclass Unseen | Subclass AUROC  |
| ----- | ------ | --------- | ---- | ---- | ---------------- | -------------- | --------------- | --------------- |
| 10    | 0      | 3         | 3    | -1   | 85.67% ± 0.07%   | 89.65% ± 0.15% | 82.27% ± 0.15%  | 0.9439 ± 0.0008 |
| 10    | 0      | 3         | 5    | -1   | 86.23% ± 0.07%   | 85.18% ± 0.36% | 87.12% ± 0.24%  | 0.9367 ± 0.0007 |
| 10    | 0      | 3         | 10   | -1   | 85.16% ± 0.26%   | 77.92% ± 0.32% | 91.34% ± 0.27%  | 0.9168 ± 0.0011 |
| 10    | 0      | 3         | 5    | 4    | 85.96% ± 0.66%   | 84.55% ± 0.50% | 87.16% ± 0.96%  | 0.9312 ± 0.0031 |
| 10    | 0      | 3         | 3    | 4    | 85.00% ± 0.69%   | 88.35% ± 0.59% | 82.14% ± 1.01%  | 0.9377 ± 0.0027 |
| 10    | 0.1    | 3         | 3    | -1   | 86.35% ± 0.14%   | 89.61% ± 0.45% | 83.58% ± 0.44%  | 0.9355 ± 0.0011 |
| 10    | 0.1    | 3         | 5    | -1   | 86.62% ± 0.16%   | 84.47% ± 0.38% | 88.46% ± 0.11%  | 0.9281 ± 0.0026 |



# CAC + OpenMax + OpenMix

| alpha | lambda | lambda_open | alpha_max | tail | se   | Subclass Overall | Subclass Seen  | Subclass Unseen | Subclass AUROC  |
| ----- | ------ | ----------- | --------- | ---- | ---- | ---------------- | -------------- | --------------- | --------------- |
| 10    | 0      | 0.3         | 3         | 3    | 4    | 79.66% ± 0.89%   | 85.92% ± 0.42% | 74.31% ± 1.44%  | 0.8218 ± 0.0027 |
| 10    | 0      | 0.3         | 3         | 3    | -1   | 78.05% ± 0.18%   | 88.12% ± 0.16% | 69.46% ± 0.43%  | 0.8732 ± 0.0026 |
| 10    | 0      | 0.3         | 5         | 10   | -1   |                  |                |                 |                 |